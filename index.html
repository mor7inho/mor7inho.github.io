<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<title>Sala de Quest√µes</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root {
    --blue: #3b82f6;
    --green: #22c55e;
    --red: #ef4444;
    --muted: #9ca3af;
    --bg-dark: #1e2530;
    --bg-card: #252c3a;
    --text-light: #e5e7eb;
  }

  body {
    font-family: "Inter", "Segoe UI", sans-serif;
    background: var(--bg-dark);
    color: var(--text-light);
    margin: 0;
    padding: 32px;
  }

  .wrap {
    max-width: 900px;
    margin: 0 auto;
  }

  .card {
    background: var(--bg-card);
    border-radius: 14px;
    padding: 32px;
    box-shadow: none;
    border: none;
  }

  h1 {
    text-align: center;
    margin-bottom: 20px;
    font-weight: 600;
  }

  img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 12px 0;
  }

  #fontControls {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 14px;
    font-size: 14px;
    color: var(--muted);
  }

  #meta {
    color: var(--muted);
    font-size: 14px;
    margin-bottom: 18px;
  }

  #enunciado {
    font-size: 18px;
    line-height: 1.7;
    margin-bottom: 18px;
    padding: 16px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
    transition: font-size 0.3s ease;
  }

  .alt-btn {
    display: block;
    width: 100%;
    text-align: left;
    padding: 12px 14px;
    border-radius: 8px;
    border: none;
    background: rgba(255, 255, 255, 0.06);
    color: inherit;
    cursor: pointer;
    margin-bottom: 8px;
    transition: background 0.2s ease;
  }

  .alt-btn:hover {
    background: rgba(255, 255, 255, 0.12);
  }

  .alt-btn.selected {
    background: rgba(59, 130, 246, 0.25);
  }

  .alt-btn.correct {
    background: rgba(34, 197, 94, 0.25);
  }

  .alt-btn.wrong {
    background: rgba(239, 68, 68, 0.25);
  }

  .feedback-controls {
    display: none;
    gap: 10px;
    margin-top: 14px;
  }

  .btn {
    padding: 10px 16px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: var(--blue);
    color: #fff;
    font-weight: 500;
    transition: background 0.2s ease;
  }

  .btn:hover {
    background: #2563eb;
  }

  .btn-green { background: var(--green); }
  .btn-red { background: var(--red); }

  .controls {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
  }

  #stats {
    margin-top: 20px;
    font-size: 14px;
    color: var(--muted);
  }

  #comentariosBox {
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    margin-top: 20px;
    padding-top: 10px;
    display: none;
  }

  /* --- Coment√°rios mais claros e leg√≠veis --- */
  .comentario {
    background: rgba(255, 255, 255, 0.9);
    color: #1e293b;
    border: none;
    border-radius: 10px;
    padding: 14px 16px;
    margin-bottom: 14px;
    font-size: 15px;
    line-height: 1.6;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
  }

  .comentario em {
    color: #475569;
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Sala de Quest√µes</h1>

    <div id="fontControls">
      <label for="fontSizeRange">Tamanho da fonte das quest√µes:</label>
      <input type="range" id="fontSizeRange" min="16" max="28" value="18">
    </div>

    <div id="meta">Carregando quest√µes...</div>
    <div id="enunciado"></div>
    <div id="alternativas"></div>

    <div class="feedback-controls" id="feedback">
      <button id="btnAcertou" class="btn btn-green">Acertei</button>
      <button id="btnErrou" class="btn btn-red">Errei</button>
    </div>

    <div class="controls">
      <button id="prevBtn" class="btn">Anterior</button>
      <button id="nextBtn" class="btn">Pr√≥xima</button>
      <button id="toggleComments" class="btn" style="background: var(--muted);">üí¨ Coment√°rios</button>
    </div>

    <div id="stats">Progresso: 0 / 0 ‚Äî Acertos: 0 ‚Äî Erros: 0 ‚Äî Pontos: 0</div>

    <div id="comentariosBox">
      <strong>Coment√°rios dos alunos:</strong>
      <div id="comentariosContent"></div>
    </div>
  </div>
</div>

<script>
(async function(){
  const JSON_FILE = "questoes_qconcursos.json";
  let questoes = [];
  let idx = 0;
  const stats = { total: 0, respondidas: 0, acertos: 0, erros: 0, pontos: 0 };
  let ultimaSelecionada = null;
  let comentariosVisiveis = false;

  async function carregar(){
    try {
      const res = await fetch(JSON_FILE);
      questoes = await res.json();
      stats.total = questoes.length;
      renderQuestao(0);
      atualizarStats();
    } catch(e){
      document.getElementById('enunciado').textContent = 'Erro ao carregar as quest√µes.';
    }
  }

  function atualizarStats(){
    document.getElementById('stats').textContent = 
      `Progresso: ${stats.respondidas} / ${stats.total} ‚Äî Acertos: ${stats.acertos} ‚Äî Erros: ${stats.erros} ‚Äî Pontos: ${stats.pontos}`;
  }

  function renderQuestao(i){
    if(!questoes.length) return;
    idx = ((i % questoes.length) + questoes.length) % questoes.length;
    const q = questoes[idx];

    document.getElementById("meta").textContent = `${q.dados?.prova || ''} ‚Ä¢ ${q.dados?.ano || ''}`;
    document.getElementById("enunciado").innerHTML = q.enunciado;

    const altContainer = document.getElementById("alternativas");
    altContainer.innerHTML = '';
    document.getElementById('comentariosContent').innerHTML = '';
    document.getElementById('feedback').style.display = 'none';
    ultimaSelecionada = null;

    (q.alternativas || []).forEach(a => {
      const btn = document.createElement('button');
      btn.className = 'alt-btn';
      btn.textContent = `${a.letra}) ${a.texto}`;

      if (q.status === 'acertou' && a.letra === q.alternativaSelecionada) btn.classList.add('correct');
      if (q.status === 'errou' && a.letra === q.alternativaSelecionada) btn.classList.add('wrong');
      if (a.letra === q.alternativaSelecionada) ultimaSelecionada = btn;

      btn.onclick = () => {
        document.querySelectorAll('.alt-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        ultimaSelecionada = btn;
        q.alternativaSelecionada = a.letra;
        mostrarComentarios(q);
        document.getElementById('feedback').style.display = 'flex';
      };
      altContainer.appendChild(btn);
    });

    if (q.respondida) mostrarComentarios(q);
  }

  function mostrarComentarios(q){
    const box = document.getElementById('comentariosBox');
    const content = document.getElementById('comentariosContent');
    content.innerHTML = '';

    if(q.comentarios?.itens?.length){
      q.comentarios.itens.forEach(c => {
        const bloco = document.createElement('div');
        bloco.className = 'comentario';
        bloco.innerHTML = c;
        content.appendChild(bloco);
      });
    } else {
      content.innerHTML = '<div class="comentario"><em>Sem coment√°rios.</em></div>';
    }

    box.style.display = 'block';
  }

  document.getElementById('btnAcertou').onclick = () => {
    if (ultimaSelecionada) {
      ultimaSelecionada.classList.remove('wrong');
      ultimaSelecionada.classList.add('correct');
      const q = questoes[idx];
      q.respondida = true;
      q.status = 'acertou';
      q.alternativaSelecionada = ultimaSelecionada.textContent.charAt(0);
      stats.acertos++;
      stats.respondidas++;
      stats.pontos += 10;
      atualizarStats();
      mostrarComentarios(q);
    }
  };

  document.getElementById('btnErrou').onclick = () => {
    if (ultimaSelecionada) {
      ultimaSelecionada.classList.remove('correct');
      ultimaSelecionada.classList.add('wrong');
      const q = questoes[idx];
      q.respondida = true;
      q.status = 'errou';
      q.alternativaSelecionada = ultimaSelecionada.textContent.charAt(0);
      stats.erros++;
      stats.respondidas++;
      stats.pontos -= 5;
      atualizarStats();
      mostrarComentarios(q);
    }
  };

  document.getElementById('toggleComments').onclick = () => {
    comentariosVisiveis = !comentariosVisiveis;
    const box = document.getElementById('comentariosBox');
    box.style.display = comentariosVisiveis ? 'block' : 'none';
  };

  document.getElementById('nextBtn').onclick = () => renderQuestao(idx + 1);
  document.getElementById('prevBtn').onclick = () => renderQuestao(idx - 1);

  document.getElementById('fontSizeRange').addEventListener('input', (e) => {
    document.getElementById('enunciado').style.fontSize = e.target.value + 'px';
  });

  await carregar();
})();
</script>
</body>
</html>

